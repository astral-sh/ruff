---
source: crates/ruff_python_parser/tests/fixtures.rs
input_file: crates/ruff_python_parser/resources/valid/expressions/set_comprehension.py
---
## AST

```
Module(
    ModModule {
        range: 0..534,
        body: [
            Expr(
                StmtExpr {
                    range: 0..15,
                    value: SetComp(
                        ExprSetComp {
                            range: 0..15,
                            elt: Name(
                                ExprName {
                                    range: 1..2,
                                    id: Name("x"),
                                    ctx: Load,
                                },
                            ),
                            generators: [
                                Comprehension {
                                    range: 3..14,
                                    target: Name(
                                        ExprName {
                                            range: 7..8,
                                            id: Name("i"),
                                            ctx: Store,
                                        },
                                    ),
                                    iter: Name(
                                        ExprName {
                                            range: 12..14,
                                            id: Name("ll"),
                                            ctx: Load,
                                        },
                                    ),
                                    ifs: [],
                                    is_async: false,
                                },
                            ],
                        },
                    ),
                },
            ),
            Expr(
                StmtExpr {
                    range: 16..57,
                    value: SetComp(
                        ExprSetComp {
                            range: 16..57,
                            elt: Name(
                                ExprName {
                                    range: 17..18,
                                    id: Name("b"),
                                    ctx: Load,
                                },
                            ),
                            generators: [
                                Comprehension {
                                    range: 19..56,
                                    target: Name(
                                        ExprName {
                                            range: 23..24,
                                            id: Name("c"),
                                            ctx: Store,
                                        },
                                    ),
                                    iter: Name(
                                        ExprName {
                                            range: 28..29,
                                            id: Name("d"),
                                            ctx: Load,
                                        },
                                    ),
                                    ifs: [
                                        Compare(
                                            ExprCompare {
                                                range: 33..39,
                                                left: Name(
                                                    ExprName {
                                                        range: 33..34,
                                                        id: Name("x"),
                                                        ctx: Load,
                                                    },
                                                ),
                                                ops: [
                                                    In,
                                                ],
                                                comparators: [
                                                    Name(
                                                        ExprName {
                                                            range: 38..39,
                                                            id: Name("w"),
                                                            ctx: Load,
                                                        },
                                                    ),
                                                ],
                                            },
                                        ),
                                        BoolOp(
                                            ExprBoolOp {
                                                range: 43..51,
                                                op: And,
                                                values: [
                                                    Name(
                                                        ExprName {
                                                            range: 43..44,
                                                            id: Name("y"),
                                                            ctx: Load,
                                                        },
                                                    ),
                                                    Name(
                                                        ExprName {
                                                            range: 49..51,
                                                            id: Name("yy"),
                                                            ctx: Load,
                                                        },
                                                    ),
                                                ],
                                            },
                                        ),
                                        Name(
                                            ExprName {
                                                range: 55..56,
                                                id: Name("z"),
                                                ctx: Load,
                                            },
                                        ),
                                    ],
                                    is_async: false,
                                },
                            ],
                        },
                    ),
                },
            ),
            Expr(
                StmtExpr {
                    range: 58..103,
                    value: SetComp(
                        ExprSetComp {
                            range: 58..103,
                            elt: Name(
                                ExprName {
                                    range: 59..60,
                                    id: Name("a"),
                                    ctx: Load,
                                },
                            ),
                            generators: [
                                Comprehension {
                                    range: 61..82,
                                    target: Name(
                                        ExprName {
                                            range: 65..66,
                                            id: Name("b"),
                                            ctx: Store,
                                        },
                                    ),
                                    iter: Name(
                                        ExprName {
                                            range: 70..71,
                                            id: Name("c"),
                                            ctx: Load,
                                        },
                                    ),
                                    ifs: [
                                        BoolOp(
                                            ExprBoolOp {
                                                range: 75..82,
                                                op: And,
                                                values: [
                                                    Name(
                                                        ExprName {
                                                            range: 75..76,
                                                            id: Name("d"),
                                                            ctx: Load,
                                                        },
                                                    ),
                                                    Name(
                                                        ExprName {
                                                            range: 81..82,
                                                            id: Name("e"),
                                                            ctx: Load,
                                                        },
                                                    ),
                                                ],
                                            },
                                        ),
                                    ],
                                    is_async: false,
                                },
                                Comprehension {
                                    range: 83..102,
                                    target: Name(
                                        ExprName {
                                            range: 87..88,
                                            id: Name("f"),
                                            ctx: Store,
                                        },
                                    ),
                                    iter: Name(
                                        ExprName {
                                            range: 92..93,
                                            id: Name("j"),
                                            ctx: Load,
                                        },
                                    ),
                                    ifs: [
                                        Compare(
                                            ExprCompare {
                                                range: 97..102,
                                                left: Name(
                                                    ExprName {
                                                        range: 97..98,
                                                        id: Name("k"),
                                                        ctx: Load,
                                                    },
                                                ),
                                                ops: [
                                                    Gt,
                                                ],
                                                comparators: [
                                                    Name(
                                                        ExprName {
                                                            range: 101..102,
                                                            id: Name("h"),
                                                            ctx: Load,
                                                        },
                                                    ),
                                                ],
                                            },
                                        ),
                                    ],
                                    is_async: false,
                                },
                            ],
                        },
                    ),
                },
            ),
            Expr(
                StmtExpr {
                    range: 104..155,
                    value: SetComp(
                        ExprSetComp {
                            range: 104..155,
                            elt: Name(
                                ExprName {
                                    range: 105..106,
                                    id: Name("a"),
                                    ctx: Load,
                                },
                            ),
                            generators: [
                                Comprehension {
                                    range: 107..128,
                                    target: Name(
                                        ExprName {
                                            range: 111..112,
                                            id: Name("b"),
                                            ctx: Store,
                                        },
                                    ),
                                    iter: Name(
                                        ExprName {
                                            range: 116..117,
                                            id: Name("c"),
                                            ctx: Load,
                                        },
                                    ),
                                    ifs: [
                                        BoolOp(
                                            ExprBoolOp {
                                                range: 121..128,
                                                op: And,
                                                values: [
                                                    Name(
                                                        ExprName {
                                                            range: 121..122,
                                                            id: Name("d"),
                                                            ctx: Load,
                                                        },
                                                    ),
                                                    Name(
                                                        ExprName {
                                                            range: 127..128,
                                                            id: Name("e"),
                                                            ctx: Load,
                                                        },
                                                    ),
                                                ],
                                            },
                                        ),
                                    ],
                                    is_async: false,
                                },
                                Comprehension {
                                    range: 129..154,
                                    target: Name(
                                        ExprName {
                                            range: 139..140,
                                            id: Name("f"),
                                            ctx: Store,
                                        },
                                    ),
                                    iter: Name(
                                        ExprName {
                                            range: 144..145,
                                            id: Name("j"),
                                            ctx: Load,
                                        },
                                    ),
                                    ifs: [
                                        Compare(
                                            ExprCompare {
                                                range: 149..154,
                                                left: Name(
                                                    ExprName {
                                                        range: 149..150,
                                                        id: Name("k"),
                                                        ctx: Load,
                                                    },
                                                ),
                                                ops: [
                                                    Gt,
                                                ],
                                                comparators: [
                                                    Name(
                                                        ExprName {
                                                            range: 153..154,
                                                            id: Name("h"),
                                                            ctx: Load,
                                                        },
                                                    ),
                                                ],
                                            },
                                        ),
                                    ],
                                    is_async: true,
                                },
                            ],
                        },
                    ),
                },
            ),
            Expr(
                StmtExpr {
                    range: 156..173,
                    value: SetComp(
                        ExprSetComp {
                            range: 156..173,
                            elt: Name(
                                ExprName {
                                    range: 157..158,
                                    id: Name("a"),
                                    ctx: Load,
                                },
                            ),
                            generators: [
                                Comprehension {
                                    range: 159..172,
                                    target: Tuple(
                                        ExprTuple {
                                            range: 163..167,
                                            elts: [
                                                Name(
                                                    ExprName {
                                                        range: 163..164,
                                                        id: Name("a"),
                                                        ctx: Store,
                                                    },
                                                ),
                                                Name(
                                                    ExprName {
                                                        range: 166..167,
                                                        id: Name("b"),
                                                        ctx: Store,
                                                    },
                                                ),
                                            ],
                                            ctx: Store,
                                            parenthesized: false,
                                        },
                                    ),
                                    iter: Name(
                                        ExprName {
                                            range: 171..172,
                                            id: Name("G"),
                                            ctx: Load,
                                        },
                                    ),
                                    ifs: [],
                                    is_async: false,
                                },
                            ],
                        },
                    ),
                },
            ),
            FunctionDef(
                StmtFunctionDef {
                    range: 312..383,
                    is_async: false,
                    decorator_list: [],
                    name: Identifier {
                        id: Name("outer"),
                        range: 316..321,
                    },
                    type_params: None,
                    parameters: Parameters {
                        range: 321..323,
                        posonlyargs: [],
                        args: [],
                        vararg: None,
                        kwonlyargs: [],
                        kwarg: None,
                    },
                    returns: None,
                    body: [
                        Expr(
                            StmtExpr {
                                range: 329..351,
                                value: SetComp(
                                    ExprSetComp {
                                        range: 329..351,
                                        elt: Name(
                                            ExprName {
                                                range: 330..331,
                                                id: Name("x"),
                                                ctx: Load,
                                            },
                                        ),
                                        generators: [
                                            Comprehension {
                                                range: 332..350,
                                                target: Name(
                                                    ExprName {
                                                        range: 336..337,
                                                        id: Name("x"),
                                                        ctx: Store,
                                                    },
                                                ),
                                                iter: Yield(
                                                    ExprYield {
                                                        range: 342..349,
                                                        value: Some(
                                                            Name(
                                                                ExprName {
                                                                    range: 348..349,
                                                                    id: Name("y"),
                                                                    ctx: Load,
                                                                },
                                                            ),
                                                        ),
                                                    },
                                                ),
                                                ifs: [],
                                                is_async: false,
                                            },
                                        ],
                                    },
                                ),
                            },
                        ),
                        Expr(
                            StmtExpr {
                                range: 356..383,
                                value: SetComp(
                                    ExprSetComp {
                                        range: 356..383,
                                        elt: Name(
                                            ExprName {
                                                range: 357..358,
                                                id: Name("x"),
                                                ctx: Load,
                                            },
                                        ),
                                        generators: [
                                            Comprehension {
                                                range: 359..382,
                                                target: Name(
                                                    ExprName {
                                                        range: 363..364,
                                                        id: Name("x"),
                                                        ctx: Store,
                                                    },
                                                ),
                                                iter: YieldFrom(
                                                    ExprYieldFrom {
                                                        range: 369..381,
                                                        value: Name(
                                                            ExprName {
                                                                range: 380..381,
                                                                id: Name("y"),
                                                                ctx: Load,
                                                            },
                                                        ),
                                                    },
                                                ),
                                                ifs: [],
                                                is_async: false,
                                            },
                                        ],
                                    },
                                ),
                            },
                        ),
                    ],
                },
            ),
            Expr(
                StmtExpr {
                    range: 384..410,
                    value: SetComp(
                        ExprSetComp {
                            range: 384..410,
                            elt: Name(
                                ExprName {
                                    range: 385..386,
                                    id: Name("x"),
                                    ctx: Load,
                                },
                            ),
                            generators: [
                                Comprehension {
                                    range: 387..409,
                                    target: Name(
                                        ExprName {
                                            range: 391..392,
                                            id: Name("x"),
                                            ctx: Store,
                                        },
                                    ),
                                    iter: Lambda(
                                        ExprLambda {
                                            range: 397..408,
                                            parameters: Some(
                                                Parameters {
                                                    range: 404..405,
                                                    posonlyargs: [],
                                                    args: [
                                                        ParameterWithDefault {
                                                            range: 404..405,
                                                            parameter: Parameter {
                                                                range: 404..405,
                                                                name: Identifier {
                                                                    id: Name("y"),
                                                                    range: 404..405,
                                                                },
                                                                annotation: None,
                                                            },
                                                            default: None,
                                                        },
                                                    ],
                                                    vararg: None,
                                                    kwonlyargs: [],
                                                    kwarg: None,
                                                },
                                            ),
                                            body: Name(
                                                ExprName {
                                                    range: 407..408,
                                                    id: Name("y"),
                                                    ctx: Load,
                                                },
                                            ),
                                        },
                                    ),
                                    ifs: [],
                                    is_async: false,
                                },
                            ],
                        },
                    ),
                },
            ),
            FunctionDef(
                StmtFunctionDef {
                    range: 411..498,
                    is_async: false,
                    decorator_list: [],
                    name: Identifier {
                        id: Name("outer"),
                        range: 415..420,
                    },
                    type_params: None,
                    parameters: Parameters {
                        range: 420..422,
                        posonlyargs: [],
                        args: [],
                        vararg: None,
                        kwonlyargs: [],
                        kwarg: None,
                    },
                    returns: None,
                    body: [
                        Expr(
                            StmtExpr {
                                range: 428..458,
                                value: SetComp(
                                    ExprSetComp {
                                        range: 428..458,
                                        elt: Name(
                                            ExprName {
                                                range: 429..430,
                                                id: Name("x"),
                                                ctx: Load,
                                            },
                                        ),
                                        generators: [
                                            Comprehension {
                                                range: 431..457,
                                                target: Name(
                                                    ExprName {
                                                        range: 435..436,
                                                        id: Name("x"),
                                                        ctx: Store,
                                                    },
                                                ),
                                                iter: Name(
                                                    ExprName {
                                                        range: 440..444,
                                                        id: Name("data"),
                                                        ctx: Load,
                                                    },
                                                ),
                                                ifs: [
                                                    Yield(
                                                        ExprYield {
                                                            range: 449..456,
                                                            value: Some(
                                                                Name(
                                                                    ExprName {
                                                                        range: 455..456,
                                                                        id: Name("y"),
                                                                        ctx: Load,
                                                                    },
                                                                ),
                                                            ),
                                                        },
                                                    ),
                                                ],
                                                is_async: false,
                                            },
                                        ],
                                    },
                                ),
                            },
                        ),
                        Expr(
                            StmtExpr {
                                range: 463..498,
                                value: SetComp(
                                    ExprSetComp {
                                        range: 463..498,
                                        elt: Name(
                                            ExprName {
                                                range: 464..465,
                                                id: Name("x"),
                                                ctx: Load,
                                            },
                                        ),
                                        generators: [
                                            Comprehension {
                                                range: 466..497,
                                                target: Name(
                                                    ExprName {
                                                        range: 470..471,
                                                        id: Name("x"),
                                                        ctx: Store,
                                                    },
                                                ),
                                                iter: Name(
                                                    ExprName {
                                                        range: 475..479,
                                                        id: Name("data"),
                                                        ctx: Load,
                                                    },
                                                ),
                                                ifs: [
                                                    YieldFrom(
                                                        ExprYieldFrom {
                                                            range: 484..496,
                                                            value: Name(
                                                                ExprName {
                                                                    range: 495..496,
                                                                    id: Name("y"),
                                                                    ctx: Load,
                                                                },
                                                            ),
                                                        },
                                                    ),
                                                ],
                                                is_async: false,
                                            },
                                        ],
                                    },
                                ),
                            },
                        ),
                    ],
                },
            ),
            Expr(
                StmtExpr {
                    range: 499..533,
                    value: SetComp(
                        ExprSetComp {
                            range: 499..533,
                            elt: Name(
                                ExprName {
                                    range: 500..501,
                                    id: Name("x"),
                                    ctx: Load,
                                },
                            ),
                            generators: [
                                Comprehension {
                                    range: 502..532,
                                    target: Name(
                                        ExprName {
                                            range: 506..507,
                                            id: Name("x"),
                                            ctx: Store,
                                        },
                                    ),
                                    iter: Name(
                                        ExprName {
                                            range: 511..515,
                                            id: Name("data"),
                                            ctx: Load,
                                        },
                                    ),
                                    ifs: [
                                        Lambda(
                                            ExprLambda {
                                                range: 520..531,
                                                parameters: Some(
                                                    Parameters {
                                                        range: 527..528,
                                                        posonlyargs: [],
                                                        args: [
                                                            ParameterWithDefault {
                                                                range: 527..528,
                                                                parameter: Parameter {
                                                                    range: 527..528,
                                                                    name: Identifier {
                                                                        id: Name("y"),
                                                                        range: 527..528,
                                                                    },
                                                                    annotation: None,
                                                                },
                                                                default: None,
                                                            },
                                                        ],
                                                        vararg: None,
                                                        kwonlyargs: [],
                                                        kwarg: None,
                                                    },
                                                ),
                                                body: Name(
                                                    ExprName {
                                                        range: 530..531,
                                                        id: Name("y"),
                                                        ctx: Load,
                                                    },
                                                ),
                                            },
                                        ),
                                    ],
                                    is_async: false,
                                },
                            ],
                        },
                    ),
                },
            ),
        ],
    },
)
```
