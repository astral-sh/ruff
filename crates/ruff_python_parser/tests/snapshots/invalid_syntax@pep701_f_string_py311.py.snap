---
source: crates/ruff_python_parser/tests/fixtures.rs
input_file: crates/ruff_python_parser/resources/inline/err/pep701_f_string_py311.py
---
## AST

```
Module(
    ModModule {
        range: 0..276,
        body: [
            Expr(
                StmtExpr {
                    range: 44..74,
                    value: FString(
                        ExprFString {
                            range: 44..74,
                            value: FStringValue {
                                inner: Single(
                                    FString(
                                        FString {
                                            range: 44..74,
                                            elements: [
                                                Literal(
                                                    FStringLiteralElement {
                                                        range: 46..58,
                                                        value: "Magic wand: ",
                                                    },
                                                ),
                                                Expression(
                                                    FStringExpressionElement {
                                                        range: 58..73,
                                                        expression: Subscript(
                                                            ExprSubscript {
                                                                range: 60..71,
                                                                value: Name(
                                                                    ExprName {
                                                                        range: 60..63,
                                                                        id: Name("bag"),
                                                                        ctx: Load,
                                                                    },
                                                                ),
                                                                slice: StringLiteral(
                                                                    ExprStringLiteral {
                                                                        range: 64..70,
                                                                        value: StringLiteralValue {
                                                                            inner: Single(
                                                                                StringLiteral {
                                                                                    range: 64..70,
                                                                                    value: "wand",
                                                                                    flags: StringLiteralFlags {
                                                                                        quote_style: Single,
                                                                                        prefix: Empty,
                                                                                        triple_quoted: false,
                                                                                    },
                                                                                },
                                                                            ),
                                                                        },
                                                                    },
                                                                ),
                                                                ctx: Load,
                                                            },
                                                        ),
                                                        debug_text: None,
                                                        conversion: None,
                                                        format_spec: None,
                                                    },
                                                ),
                                            ],
                                            flags: FStringFlags {
                                                quote_style: Single,
                                                prefix: Regular,
                                                triple_quoted: false,
                                            },
                                        },
                                    ),
                                ),
                            },
                        },
                    ),
                },
            ),
            Expr(
                StmtExpr {
                    range: 95..112,
                    value: FString(
                        ExprFString {
                            range: 95..112,
                            value: FStringValue {
                                inner: Single(
                                    FString(
                                        FString {
                                            range: 95..112,
                                            elements: [
                                                Expression(
                                                    FStringExpressionElement {
                                                        range: 97..111,
                                                        expression: Call(
                                                            ExprCall {
                                                                range: 98..110,
                                                                func: Attribute(
                                                                    ExprAttribute {
                                                                        range: 98..107,
                                                                        value: StringLiteral(
                                                                            ExprStringLiteral {
                                                                                range: 98..102,
                                                                                value: StringLiteralValue {
                                                                                    inner: Single(
                                                                                        StringLiteral {
                                                                                            range: 98..102,
                                                                                            value: "\n",
                                                                                            flags: StringLiteralFlags {
                                                                                                quote_style: Single,
                                                                                                prefix: Empty,
                                                                                                triple_quoted: false,
                                                                                            },
                                                                                        },
                                                                                    ),
                                                                                },
                                                                            },
                                                                        ),
                                                                        attr: Identifier {
                                                                            id: Name("join"),
                                                                            range: 103..107,
                                                                        },
                                                                        ctx: Load,
                                                                    },
                                                                ),
                                                                arguments: Arguments {
                                                                    range: 107..110,
                                                                    args: [
                                                                        Name(
                                                                            ExprName {
                                                                                range: 108..109,
                                                                                id: Name("a"),
                                                                                ctx: Load,
                                                                            },
                                                                        ),
                                                                    ],
                                                                    keywords: [],
                                                                },
                                                            },
                                                        ),
                                                        debug_text: None,
                                                        conversion: None,
                                                        format_spec: None,
                                                    },
                                                ),
                                            ],
                                            flags: FStringFlags {
                                                quote_style: Double,
                                                prefix: Regular,
                                                triple_quoted: false,
                                            },
                                        },
                                    ),
                                ),
                            },
                        },
                    ),
                },
            ),
            Expr(
                StmtExpr {
                    range: 148..220,
                    value: FString(
                        ExprFString {
                            range: 148..220,
                            value: FStringValue {
                                inner: Single(
                                    FString(
                                        FString {
                                            range: 148..220,
                                            elements: [
                                                Literal(
                                                    FStringLiteralElement {
                                                        range: 152..169,
                                                        value: "A complex trick: ",
                                                    },
                                                ),
                                                Expression(
                                                    FStringExpressionElement {
                                                        range: 169..217,
                                                        expression: Subscript(
                                                            ExprSubscript {
                                                                range: 175..185,
                                                                value: Name(
                                                                    ExprName {
                                                                        range: 175..178,
                                                                        id: Name("bag"),
                                                                        ctx: Load,
                                                                    },
                                                                ),
                                                                slice: StringLiteral(
                                                                    ExprStringLiteral {
                                                                        range: 179..184,
                                                                        value: StringLiteralValue {
                                                                            inner: Single(
                                                                                StringLiteral {
                                                                                    range: 179..184,
                                                                                    value: "bag",
                                                                                    flags: StringLiteralFlags {
                                                                                        quote_style: Single,
                                                                                        prefix: Empty,
                                                                                        triple_quoted: false,
                                                                                    },
                                                                                },
                                                                            ),
                                                                        },
                                                                    },
                                                                ),
                                                                ctx: Load,
                                                            },
                                                        ),
                                                        debug_text: None,
                                                        conversion: None,
                                                        format_spec: None,
                                                    },
                                                ),
                                            ],
                                            flags: FStringFlags {
                                                quote_style: Single,
                                                prefix: Regular,
                                                triple_quoted: true,
                                            },
                                        },
                                    ),
                                ),
                            },
                        },
                    ),
                },
            ),
            Expr(
                StmtExpr {
                    range: 221..254,
                    value: FString(
                        ExprFString {
                            range: 221..254,
                            value: FStringValue {
                                inner: Single(
                                    FString(
                                        FString {
                                            range: 221..254,
                                            elements: [
                                                Expression(
                                                    FStringExpressionElement {
                                                        range: 223..253,
                                                        expression: FString(
                                                            ExprFString {
                                                                range: 224..252,
                                                                value: FStringValue {
                                                                    inner: Single(
                                                                        FString(
                                                                            FString {
                                                                                range: 224..252,
                                                                                elements: [
                                                                                    Expression(
                                                                                        FStringExpressionElement {
                                                                                            range: 226..251,
                                                                                            expression: FString(
                                                                                                ExprFString {
                                                                                                    range: 227..250,
                                                                                                    value: FStringValue {
                                                                                                        inner: Single(
                                                                                                            FString(
                                                                                                                FString {
                                                                                                                    range: 227..250,
                                                                                                                    elements: [
                                                                                                                        Expression(
                                                                                                                            FStringExpressionElement {
                                                                                                                                range: 229..249,
                                                                                                                                expression: FString(
                                                                                                                                    ExprFString {
                                                                                                                                        range: 230..248,
                                                                                                                                        value: FStringValue {
                                                                                                                                            inner: Single(
                                                                                                                                                FString(
                                                                                                                                                    FString {
                                                                                                                                                        range: 230..248,
                                                                                                                                                        elements: [
                                                                                                                                                            Expression(
                                                                                                                                                                FStringExpressionElement {
                                                                                                                                                                    range: 232..247,
                                                                                                                                                                    expression: FString(
                                                                                                                                                                        ExprFString {
                                                                                                                                                                            range: 233..246,
                                                                                                                                                                            value: FStringValue {
                                                                                                                                                                                inner: Single(
                                                                                                                                                                                    FString(
                                                                                                                                                                                        FString {
                                                                                                                                                                                            range: 233..246,
                                                                                                                                                                                            elements: [
                                                                                                                                                                                                Expression(
                                                                                                                                                                                                    FStringExpressionElement {
                                                                                                                                                                                                        range: 235..245,
                                                                                                                                                                                                        expression: FString(
                                                                                                                                                                                                            ExprFString {
                                                                                                                                                                                                                range: 236..244,
                                                                                                                                                                                                                value: FStringValue {
                                                                                                                                                                                                                    inner: Single(
                                                                                                                                                                                                                        FString(
                                                                                                                                                                                                                            FString {
                                                                                                                                                                                                                                range: 236..244,
                                                                                                                                                                                                                                elements: [
                                                                                                                                                                                                                                    Expression(
                                                                                                                                                                                                                                        FStringExpressionElement {
                                                                                                                                                                                                                                            range: 238..243,
                                                                                                                                                                                                                                            expression: BinOp(
                                                                                                                                                                                                                                                ExprBinOp {
                                                                                                                                                                                                                                                    range: 239..242,
                                                                                                                                                                                                                                                    left: NumberLiteral(
                                                                                                                                                                                                                                                        ExprNumberLiteral {
                                                                                                                                                                                                                                                            range: 239..240,
                                                                                                                                                                                                                                                            value: Int(
                                                                                                                                                                                                                                                                1,
                                                                                                                                                                                                                                                            ),
                                                                                                                                                                                                                                                        },
                                                                                                                                                                                                                                                    ),
                                                                                                                                                                                                                                                    op: Add,
                                                                                                                                                                                                                                                    right: NumberLiteral(
                                                                                                                                                                                                                                                        ExprNumberLiteral {
                                                                                                                                                                                                                                                            range: 241..242,
                                                                                                                                                                                                                                                            value: Int(
                                                                                                                                                                                                                                                                1,
                                                                                                                                                                                                                                                            ),
                                                                                                                                                                                                                                                        },
                                                                                                                                                                                                                                                    ),
                                                                                                                                                                                                                                                },
                                                                                                                                                                                                                                            ),
                                                                                                                                                                                                                                            debug_text: None,
                                                                                                                                                                                                                                            conversion: None,
                                                                                                                                                                                                                                            format_spec: None,
                                                                                                                                                                                                                                        },
                                                                                                                                                                                                                                    ),
                                                                                                                                                                                                                                ],
                                                                                                                                                                                                                                flags: FStringFlags {
                                                                                                                                                                                                                                    quote_style: Double,
                                                                                                                                                                                                                                    prefix: Regular,
                                                                                                                                                                                                                                    triple_quoted: false,
                                                                                                                                                                                                                                },
                                                                                                                                                                                                                            },
                                                                                                                                                                                                                        ),
                                                                                                                                                                                                                    ),
                                                                                                                                                                                                                },
                                                                                                                                                                                                            },
                                                                                                                                                                                                        ),
                                                                                                                                                                                                        debug_text: None,
                                                                                                                                                                                                        conversion: None,
                                                                                                                                                                                                        format_spec: None,
                                                                                                                                                                                                    },
                                                                                                                                                                                                ),
                                                                                                                                                                                            ],
                                                                                                                                                                                            flags: FStringFlags {
                                                                                                                                                                                                quote_style: Double,
                                                                                                                                                                                                prefix: Regular,
                                                                                                                                                                                                triple_quoted: false,
                                                                                                                                                                                            },
                                                                                                                                                                                        },
                                                                                                                                                                                    ),
                                                                                                                                                                                ),
                                                                                                                                                                            },
                                                                                                                                                                        },
                                                                                                                                                                    ),
                                                                                                                                                                    debug_text: None,
                                                                                                                                                                    conversion: None,
                                                                                                                                                                    format_spec: None,
                                                                                                                                                                },
                                                                                                                                                            ),
                                                                                                                                                        ],
                                                                                                                                                        flags: FStringFlags {
                                                                                                                                                            quote_style: Double,
                                                                                                                                                            prefix: Regular,
                                                                                                                                                            triple_quoted: false,
                                                                                                                                                        },
                                                                                                                                                    },
                                                                                                                                                ),
                                                                                                                                            ),
                                                                                                                                        },
                                                                                                                                    },
                                                                                                                                ),
                                                                                                                                debug_text: None,
                                                                                                                                conversion: None,
                                                                                                                                format_spec: None,
                                                                                                                            },
                                                                                                                        ),
                                                                                                                    ],
                                                                                                                    flags: FStringFlags {
                                                                                                                        quote_style: Double,
                                                                                                                        prefix: Regular,
                                                                                                                        triple_quoted: false,
                                                                                                                    },
                                                                                                                },
                                                                                                            ),
                                                                                                        ),
                                                                                                    },
                                                                                                },
                                                                                            ),
                                                                                            debug_text: None,
                                                                                            conversion: None,
                                                                                            format_spec: None,
                                                                                        },
                                                                                    ),
                                                                                ],
                                                                                flags: FStringFlags {
                                                                                    quote_style: Double,
                                                                                    prefix: Regular,
                                                                                    triple_quoted: false,
                                                                                },
                                                                            },
                                                                        ),
                                                                    ),
                                                                },
                                                            },
                                                        ),
                                                        debug_text: None,
                                                        conversion: None,
                                                        format_spec: None,
                                                    },
                                                ),
                                            ],
                                            flags: FStringFlags {
                                                quote_style: Double,
                                                prefix: Regular,
                                                triple_quoted: false,
                                            },
                                        },
                                    ),
                                ),
                            },
                        },
                    ),
                },
            ),
        ],
    },
)
```
## Unsupported Syntax Errors

  |
1 | # parse_options: {"target-version": "3.11"}
2 | f'Magic wand: { bag['wand'] }'     # nested quotes
  |                     ^ Syntax Error: Cannot use PEP 701 f-strings on Python 3.11 (syntax was added in Python 3.12)
3 | f"{'\n'.join(a)}"                  # escape sequence
4 | f'''A complex trick: {
  |


  |
1 | # parse_options: {"target-version": "3.11"}
2 | f'Magic wand: { bag['wand'] }'     # nested quotes
3 | f"{'\n'.join(a)}"                  # escape sequence
  |     ^ Syntax Error: Cannot use PEP 701 f-strings on Python 3.11 (syntax was added in Python 3.12)
4 | f'''A complex trick: {
5 |     bag['bag']                     # comment
  |


  |
3 | f"{'\n'.join(a)}"                  # escape sequence
4 | f'''A complex trick: {
5 |     bag['bag']                     # comment
  |                                    ^ Syntax Error: Cannot use PEP 701 f-strings on Python 3.11 (syntax was added in Python 3.12)
6 | }'''
7 | f"{f"{f"{f"{f"{f"{1+1}"}"}"}"}"}"  # arbitrary nesting
  |


  |
5 |     bag['bag']                     # comment
6 | }'''
7 | f"{f"{f"{f"{f"{f"{1+1}"}"}"}"}"}"  # arbitrary nesting
  |                 ^ Syntax Error: Cannot use PEP 701 f-strings on Python 3.11 (syntax was added in Python 3.12)
  |


  |
5 |     bag['bag']                     # comment
6 | }'''
7 | f"{f"{f"{f"{f"{f"{1+1}"}"}"}"}"}"  # arbitrary nesting
  |              ^ Syntax Error: Cannot use PEP 701 f-strings on Python 3.11 (syntax was added in Python 3.12)
  |


  |
5 |     bag['bag']                     # comment
6 | }'''
7 | f"{f"{f"{f"{f"{f"{1+1}"}"}"}"}"}"  # arbitrary nesting
  |           ^ Syntax Error: Cannot use PEP 701 f-strings on Python 3.11 (syntax was added in Python 3.12)
  |


  |
5 |     bag['bag']                     # comment
6 | }'''
7 | f"{f"{f"{f"{f"{f"{1+1}"}"}"}"}"}"  # arbitrary nesting
  |        ^ Syntax Error: Cannot use PEP 701 f-strings on Python 3.11 (syntax was added in Python 3.12)
  |


  |
5 |     bag['bag']                     # comment
6 | }'''
7 | f"{f"{f"{f"{f"{f"{1+1}"}"}"}"}"}"  # arbitrary nesting
  |     ^ Syntax Error: Cannot use PEP 701 f-strings on Python 3.11 (syntax was added in Python 3.12)
  |
