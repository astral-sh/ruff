---
source: crates/ruff_linter/src/rules/flake8_bandit/mod.rs
---
error[S608]: 2:10: Possible SQL injection vector through string-based query construction

 --> S608.py:2:10
  |
1 | # single-line failures
2 | query1 = "SELECT %s FROM table" % (var,) # bad
  |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 | query2 = "SELECT var FROM " + table
4 | query3 = "SELECT " + val + " FROM " + table
  |
error[S608]: 3:10: Possible SQL injection vector through string-based query construction

 --> S608.py:3:10
  |
1 | # single-line failures
2 | query1 = "SELECT %s FROM table" % (var,) # bad
3 | query2 = "SELECT var FROM " + table
  |          ^^^^^^^^^^^^^^^^^^^^^^^^^^
4 | query3 = "SELECT " + val + " FROM " + table
5 | query4 = "SELECT {} FROM table;".format(var)
  |
error[S608]: 4:10: Possible SQL injection vector through string-based query construction

 --> S608.py:4:10
  |
2 | query1 = "SELECT %s FROM table" % (var,) # bad
3 | query2 = "SELECT var FROM " + table
4 | query3 = "SELECT " + val + " FROM " + table
  |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5 | query4 = "SELECT {} FROM table;".format(var)
6 | query5 = f"SELECT * FROM table WHERE var = {var}"
  |
error[S608]: 5:10: Possible SQL injection vector through string-based query construction

 --> S608.py:5:10
  |
3 | query2 = "SELECT var FROM " + table
4 | query3 = "SELECT " + val + " FROM " + table
5 | query4 = "SELECT {} FROM table;".format(var)
  |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6 | query5 = f"SELECT * FROM table WHERE var = {var}"
  |
error[S608]: 6:10: Possible SQL injection vector through string-based query construction

 --> S608.py:6:10
  |
4 | query3 = "SELECT " + val + " FROM " + table
5 | query4 = "SELECT {} FROM table;".format(var)
6 | query5 = f"SELECT * FROM table WHERE var = {var}"
  |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | 
8 | query6 = "DELETE FROM table WHERE var = %s" % (var,)
  |
error[S608]: 8:10: Possible SQL injection vector through string-based query construction

  --> S608.py:8:10
   |
 6 | query5 = f"SELECT * FROM table WHERE var = {var}"
 7 | 
 8 | query6 = "DELETE FROM table WHERE var = %s" % (var,)
   |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 | query7 = "DELETE FROM table WHERE VAR = " + var
10 | query8 = "DELETE FROM " + table + "WHERE var = " + var
   |
error[S608]: 9:10: Possible SQL injection vector through string-based query construction

  --> S608.py:9:10
   |
 8 | query6 = "DELETE FROM table WHERE var = %s" % (var,)
 9 | query7 = "DELETE FROM table WHERE VAR = " + var
   |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
10 | query8 = "DELETE FROM " + table + "WHERE var = " + var
11 | query9 = "DELETE FROM table WHERE var = {}".format(var)
   |
error[S608]: 10:10: Possible SQL injection vector through string-based query construction

  --> S608.py:10:10
   |
 8 | query6 = "DELETE FROM table WHERE var = %s" % (var,)
 9 | query7 = "DELETE FROM table WHERE VAR = " + var
10 | query8 = "DELETE FROM " + table + "WHERE var = " + var
   |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11 | query9 = "DELETE FROM table WHERE var = {}".format(var)
12 | query10 = f"DELETE FROM table WHERE var = {var}"
   |
error[S608]: 11:10: Possible SQL injection vector through string-based query construction

  --> S608.py:11:10
   |
 9 | query7 = "DELETE FROM table WHERE VAR = " + var
10 | query8 = "DELETE FROM " + table + "WHERE var = " + var
11 | query9 = "DELETE FROM table WHERE var = {}".format(var)
   |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
12 | query10 = f"DELETE FROM table WHERE var = {var}"
   |
error[S608]: 12:11: Possible SQL injection vector through string-based query construction

  --> S608.py:12:11
   |
10 | query8 = "DELETE FROM " + table + "WHERE var = " + var
11 | query9 = "DELETE FROM table WHERE var = {}".format(var)
12 | query10 = f"DELETE FROM table WHERE var = {var}"
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
13 | 
14 | query11 = "INSERT INTO table VALUES (%s)" % (var,)
   |
error[S608]: 14:11: Possible SQL injection vector through string-based query construction

  --> S608.py:14:11
   |
12 | query10 = f"DELETE FROM table WHERE var = {var}"
13 | 
14 | query11 = "INSERT INTO table VALUES (%s)" % (var,)
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
15 | query12 = "INSERT INTO TABLE VALUES (" + var + ")"
16 | query13 = "INSERT INTO {} VALUES ({})".format(table, var)
   |
error[S608]: 15:11: Possible SQL injection vector through string-based query construction

  --> S608.py:15:11
   |
14 | query11 = "INSERT INTO table VALUES (%s)" % (var,)
15 | query12 = "INSERT INTO TABLE VALUES (" + var + ")"
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
16 | query13 = "INSERT INTO {} VALUES ({})".format(table, var)
17 | query14 = f"INSERT INTO {table} VALUES var = {var}"
   |
error[S608]: 16:11: Possible SQL injection vector through string-based query construction

  --> S608.py:16:11
   |
14 | query11 = "INSERT INTO table VALUES (%s)" % (var,)
15 | query12 = "INSERT INTO TABLE VALUES (" + var + ")"
16 | query13 = "INSERT INTO {} VALUES ({})".format(table, var)
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
17 | query14 = f"INSERT INTO {table} VALUES var = {var}"
   |
error[S608]: 17:11: Possible SQL injection vector through string-based query construction

  --> S608.py:17:11
   |
15 | query12 = "INSERT INTO TABLE VALUES (" + var + ")"
16 | query13 = "INSERT INTO {} VALUES ({})".format(table, var)
17 | query14 = f"INSERT INTO {table} VALUES var = {var}"
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18 | 
19 | query15 = "UPDATE %s SET var = %s" % (table, var)
   |
error[S608]: 19:11: Possible SQL injection vector through string-based query construction

  --> S608.py:19:11
   |
17 | query14 = f"INSERT INTO {table} VALUES var = {var}"
18 | 
19 | query15 = "UPDATE %s SET var = %s" % (table, var)
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
20 | query16 = "UPDATE " + table + " SET var = " + var
21 | query17 = "UPDATE {} SET var = {}".format(table, var)
   |
error[S608]: 20:11: Possible SQL injection vector through string-based query construction

  --> S608.py:20:11
   |
19 | query15 = "UPDATE %s SET var = %s" % (table, var)
20 | query16 = "UPDATE " + table + " SET var = " + var
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
21 | query17 = "UPDATE {} SET var = {}".format(table, var)
22 | query18 = f"UPDATE {table} SET var = {var}"
   |
error[S608]: 21:11: Possible SQL injection vector through string-based query construction

  --> S608.py:21:11
   |
19 | query15 = "UPDATE %s SET var = %s" % (table, var)
20 | query16 = "UPDATE " + table + " SET var = " + var
21 | query17 = "UPDATE {} SET var = {}".format(table, var)
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
22 | query18 = f"UPDATE {table} SET var = {var}"
   |
error[S608]: 22:11: Possible SQL injection vector through string-based query construction

  --> S608.py:22:11
   |
20 | query16 = "UPDATE " + table + " SET var = " + var
21 | query17 = "UPDATE {} SET var = {}".format(table, var)
22 | query18 = f"UPDATE {table} SET var = {var}"
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 | 
24 | query19 = "select %s from table" % (var,)
   |
error[S608]: 24:11: Possible SQL injection vector through string-based query construction

  --> S608.py:24:11
   |
22 | query18 = f"UPDATE {table} SET var = {var}"
23 | 
24 | query19 = "select %s from table" % (var,)
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
25 | query20 = "select var from " + table
26 | query21 = "select " + val + " from " + table
   |
error[S608]: 25:11: Possible SQL injection vector through string-based query construction

  --> S608.py:25:11
   |
24 | query19 = "select %s from table" % (var,)
25 | query20 = "select var from " + table
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^
26 | query21 = "select " + val + " from " + table
27 | query22 = "select {} from table;".format(var)
   |
error[S608]: 26:11: Possible SQL injection vector through string-based query construction

  --> S608.py:26:11
   |
24 | query19 = "select %s from table" % (var,)
25 | query20 = "select var from " + table
26 | query21 = "select " + val + " from " + table
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
27 | query22 = "select {} from table;".format(var)
28 | query23 = f"select * from table where var = {var}"
   |
error[S608]: 27:11: Possible SQL injection vector through string-based query construction

  --> S608.py:27:11
   |
25 | query20 = "select var from " + table
26 | query21 = "select " + val + " from " + table
27 | query22 = "select {} from table;".format(var)
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
28 | query23 = f"select * from table where var = {var}"
   |
error[S608]: 28:11: Possible SQL injection vector through string-based query construction

  --> S608.py:28:11
   |
26 | query21 = "select " + val + " from " + table
27 | query22 = "select {} from table;".format(var)
28 | query23 = f"select * from table where var = {var}"
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
29 | 
30 | query24 = "delete from table where var = %s" % (var,)
   |
error[S608]: 30:11: Possible SQL injection vector through string-based query construction

  --> S608.py:30:11
   |
28 | query23 = f"select * from table where var = {var}"
29 | 
30 | query24 = "delete from table where var = %s" % (var,)
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
31 | query25 = "delete from table where var = " + var
32 | query26 = "delete from " + table + "where var = " + var
   |
error[S608]: 31:11: Possible SQL injection vector through string-based query construction

  --> S608.py:31:11
   |
30 | query24 = "delete from table where var = %s" % (var,)
31 | query25 = "delete from table where var = " + var
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
32 | query26 = "delete from " + table + "where var = " + var
33 | query27 = "delete from table where var = {}".format(var)
   |
error[S608]: 32:11: Possible SQL injection vector through string-based query construction

  --> S608.py:32:11
   |
30 | query24 = "delete from table where var = %s" % (var,)
31 | query25 = "delete from table where var = " + var
32 | query26 = "delete from " + table + "where var = " + var
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
33 | query27 = "delete from table where var = {}".format(var)
34 | query28 = f"delete from table where var = {var}"
   |
error[S608]: 33:11: Possible SQL injection vector through string-based query construction

  --> S608.py:33:11
   |
31 | query25 = "delete from table where var = " + var
32 | query26 = "delete from " + table + "where var = " + var
33 | query27 = "delete from table where var = {}".format(var)
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
34 | query28 = f"delete from table where var = {var}"
   |
error[S608]: 34:11: Possible SQL injection vector through string-based query construction

  --> S608.py:34:11
   |
32 | query26 = "delete from " + table + "where var = " + var
33 | query27 = "delete from table where var = {}".format(var)
34 | query28 = f"delete from table where var = {var}"
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
35 | 
36 | query29 = "insert into table values (%s)" % (var,)
   |
error[S608]: 36:11: Possible SQL injection vector through string-based query construction

  --> S608.py:36:11
   |
34 | query28 = f"delete from table where var = {var}"
35 | 
36 | query29 = "insert into table values (%s)" % (var,)
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
37 | query30 = "insert into table values (" + var + ")"
38 | query31 = "insert into {} values ({})".format(table, var)
   |
error[S608]: 37:11: Possible SQL injection vector through string-based query construction

  --> S608.py:37:11
   |
36 | query29 = "insert into table values (%s)" % (var,)
37 | query30 = "insert into table values (" + var + ")"
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
38 | query31 = "insert into {} values ({})".format(table, var)
39 | query32 = f"insert into {table} values var = {var}"
   |
error[S608]: 38:11: Possible SQL injection vector through string-based query construction

  --> S608.py:38:11
   |
36 | query29 = "insert into table values (%s)" % (var,)
37 | query30 = "insert into table values (" + var + ")"
38 | query31 = "insert into {} values ({})".format(table, var)
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
39 | query32 = f"insert into {table} values var = {var}"
   |
error[S608]: 39:11: Possible SQL injection vector through string-based query construction

  --> S608.py:39:11
   |
37 | query30 = "insert into table values (" + var + ")"
38 | query31 = "insert into {} values ({})".format(table, var)
39 | query32 = f"insert into {table} values var = {var}"
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
40 | 
41 | query33 = "update %s set var = %s" % (table, var)
   |
error[S608]: 41:11: Possible SQL injection vector through string-based query construction

  --> S608.py:41:11
   |
39 | query32 = f"insert into {table} values var = {var}"
40 | 
41 | query33 = "update %s set var = %s" % (table, var)
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
42 | query34 = "update " + table + " set var = " + var
43 | query35 = "update {} set var = {}".format(table, var)
   |
error[S608]: 42:11: Possible SQL injection vector through string-based query construction

  --> S608.py:42:11
   |
41 | query33 = "update %s set var = %s" % (table, var)
42 | query34 = "update " + table + " set var = " + var
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
43 | query35 = "update {} set var = {}".format(table, var)
44 | query36 = f"update {table} set var = {var}"
   |
error[S608]: 43:11: Possible SQL injection vector through string-based query construction

  --> S608.py:43:11
   |
41 | query33 = "update %s set var = %s" % (table, var)
42 | query34 = "update " + table + " set var = " + var
43 | query35 = "update {} set var = {}".format(table, var)
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
44 | query36 = f"update {table} set var = {var}"
   |
error[S608]: 44:11: Possible SQL injection vector through string-based query construction

  --> S608.py:44:11
   |
42 | query34 = "update " + table + " set var = " + var
43 | query35 = "update {} set var = {}".format(table, var)
44 | query36 = f"update {table} set var = {var}"
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
45 | 
46 | # multi-line failures
   |
error[S608]: 48:12: Possible SQL injection vector through string-based query construction

  --> S608.py:48:12
   |
46 |   # multi-line failures
47 |   def query37():
48 |       return """
   |  ____________^
49 | |     SELECT *
50 | |     FROM table
51 | |     WHERE var = %s
52 | |     """ % var
   | |_____________^
53 |   
54 |   def query38():
   |
error[S608]: 55:12: Possible SQL injection vector through string-based query construction

  --> S608.py:55:12
   |
54 |   def query38():
55 |       return """
   |  ____________^
56 | |     SELECT *
57 | |     FROM TABLE
58 | |     WHERE var =
59 | |     """ + var
   | |_____________^
60 |   
61 |   def query39():
   |
error[S608]: 62:12: Possible SQL injection vector through string-based query construction

  --> S608.py:62:12
   |
61 |   def query39():
62 |       return """
   |  ____________^
63 | |     SELECT *
64 | |     FROM table
65 | |     WHERE var = {}
66 | |     """.format(var)
   | |___________________^
67 |   
68 |   def query40():
   |
error[S608]: 69:12: Possible SQL injection vector through string-based query construction

  --> S608.py:69:12
   |
68 |   def query40():
69 |       return f"""
   |  ____________^
70 | |     SELECT *
71 | |     FROM table
72 | |     WHERE var = {var}
73 | |     """
   | |_______^
74 |   
75 |   def query41():
   |
error[S608]: 77:9: Possible SQL injection vector through string-based query construction

  --> S608.py:77:9
   |
75 |   def query41():
76 |       return (
77 |           "SELECT * "
   |  _________^
78 | |         "FROM table "
79 | |         f"WHERE var = {var}"
   | |____________________________^
80 |       )
   |
error[S608]: 83:26: Possible SQL injection vector through string-based query construction

  --> S608.py:83:26
   |
82 | # # cursor-wrapped failures
83 | query42 = cursor.execute("SELECT * FROM table WHERE var = %s" % var)
   |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
84 | query43 = cursor.execute(f"SELECT * FROM table WHERE var = {var}")
85 | query44 = cursor.execute("SELECT * FROM table WHERE var = {}".format(var))
   |
error[S608]: 84:26: Possible SQL injection vector through string-based query construction

  --> S608.py:84:26
   |
82 | # # cursor-wrapped failures
83 | query42 = cursor.execute("SELECT * FROM table WHERE var = %s" % var)
84 | query43 = cursor.execute(f"SELECT * FROM table WHERE var = {var}")
   |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
85 | query44 = cursor.execute("SELECT * FROM table WHERE var = {}".format(var))
86 | query45 = cursor.executemany("SELECT * FROM table WHERE var = %s" % var, [])
   |
error[S608]: 85:26: Possible SQL injection vector through string-based query construction

  --> S608.py:85:26
   |
83 | query42 = cursor.execute("SELECT * FROM table WHERE var = %s" % var)
84 | query43 = cursor.execute(f"SELECT * FROM table WHERE var = {var}")
85 | query44 = cursor.execute("SELECT * FROM table WHERE var = {}".format(var))
   |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
86 | query45 = cursor.executemany("SELECT * FROM table WHERE var = %s" % var, [])
   |
error[S608]: 86:30: Possible SQL injection vector through string-based query construction

  --> S608.py:86:30
   |
84 | query43 = cursor.execute(f"SELECT * FROM table WHERE var = {var}")
85 | query44 = cursor.execute("SELECT * FROM table WHERE var = {}".format(var))
86 | query45 = cursor.executemany("SELECT * FROM table WHERE var = %s" % var, [])
   |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
87 | 
88 | # # pass
   |
error[S608]: 98:9: Possible SQL injection vector through string-based query construction

   --> S608.py:98:9
    |
 97 | # # INSERT without INTO (e.g. MySQL and derivatives)
 98 | query = "INSERT table VALUES (%s)" % (var,)
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 99 | 
100 | # # REPLACE (e.g. MySQL and derivatives, SQLite)
    |
error[S608]: 101:9: Possible SQL injection vector through string-based query construction

   --> S608.py:101:9
    |
100 | # # REPLACE (e.g. MySQL and derivatives, SQLite)
101 | query = "REPLACE INTO table VALUES (%s)" % (var,)
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
102 | query = "REPLACE table VALUES (%s)" % (var,)
    |
error[S608]: 102:9: Possible SQL injection vector through string-based query construction

   --> S608.py:102:9
    |
100 | # # REPLACE (e.g. MySQL and derivatives, SQLite)
101 | query = "REPLACE INTO table VALUES (%s)" % (var,)
102 | query = "REPLACE table VALUES (%s)" % (var,)
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
103 | 
104 | query = "Deselect something that is not SQL even though it has a ' from ' somewhere in %s." % "there"
    |
error[S608]: 111:1: Possible SQL injection vector through string-based query construction

   --> S608.py:110:11
    |
110 | # # errors
111 | "SELECT * FROM " + ("table1" if x > 0 else "table2")
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
112 | "SELECT * FROM " + ("table1" if x > 0 else ["table2"])
    |
error[S608]: 112:1: Possible SQL injection vector through string-based query construction

   --> S608.py:111:53
    |
110 | # # errors
111 | "SELECT * FROM " + ("table1" if x > 0 else "table2")
112 | "SELECT * FROM " + ("table1" if x > 0 else ["table2"])
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
